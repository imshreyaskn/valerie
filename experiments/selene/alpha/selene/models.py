"""
Pydantic models for structured LLM responses.
Defines the expected schema for agent outputs.
"""
from typing import Optional
from pydantic import BaseModel, Field, validator


class EthicalDisclaimer(BaseModel):
    """Ethical disclaimer accompanying responses."""
    
    message: str = Field(
        ...,
        description="The ethical disclaimer message",
        min_length=1
    )
    
    @validator('message')
    def message_must_not_be_empty(cls, v):
        """Ensure message is not just whitespace."""
        if not v or not v.strip():
            raise ValueError('Message cannot be empty or whitespace')
        return v.strip()


class GodmodeResponse(BaseModel):
    """Adversarial prompt generated by the system."""
    
    prompt: str = Field(
        ...,
        description="The generated adversarial prompt",
        min_length=1
    )
    
    @validator('prompt')
    def prompt_must_not_be_empty(cls, v):
        """Ensure prompt is not just whitespace."""
        if not v or not v.strip():
            raise ValueError('Prompt cannot be empty or whitespace')
        return v.strip()


class ResponseSchema(BaseModel):
    """Complete response structure from the agent."""
    
    ethical_disclaimer: EthicalDisclaimer = Field(
        ...,
        description="Ethical disclaimer for the response"
    )
    godmode_response: GodmodeResponse = Field(
        ...,
        description="Generated adversarial prompt"
    )


class RootSchema(BaseModel):
    """Root schema for agent responses."""
    
    response: ResponseSchema = Field(
        ...,
        description="The complete structured response"
    )
    
    class Config:
        """Pydantic configuration."""
        validate_assignment = True